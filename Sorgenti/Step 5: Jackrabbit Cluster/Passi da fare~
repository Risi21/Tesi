http://www.greymeister.net/blog/2011/11/28/jackrabbit-clustering-primer/

http://wiki.apache.org/jackrabbit/Clustering#Easily_add_new_cluster_nodes

Definisci un nome per il repository (es cluster1)

Lancia 2 volte l'applicazione Step2 per farti creare in automatico 2 istanze di tomcat e 2 repository (nodi) jackrabbit.

Le 2 istanze si chiamano es. cluster1_1 e cluster1_2

Richiama gli scritp di stop per fermare le 2 istanze appena create.

in /srv/repo/... modifica il repository.xml delle 2 istanze:
Aggiungi il Cluster in fondo al file.
Nel Cluster aggiungi il journal nel database mysql.
Modifica il path del datastore, deve essere uguale per le 2 istanze.
Modifica l'id dei nodi, es node1 e node2.

Fai partire l'istanza 1, crea le tabelle journal in mysql.

Aggiungi il secondo nodo jackrabbit al cluster:

select * from journal_local_revisions where journal_id = 'node1';

insert into journal_local_revisions (journal_id, revision_id) values ('node2', 1);

Fai partire l'istanza di tomcat del secondo nodo.

Cambiare il sync delay, ogni quanto tempo i nodi jackrabbit leggono il journal per aggiornarsi.
